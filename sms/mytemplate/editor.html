<!DOCTYPE html>
<html lang="en">
<head>
  <title>Editor</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <!-- <link rel="stylesheet" type="text/css" href="editor.css"> -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

<style >
  body {
    position: relative; 
  }

 .affix {
    top:0;
    width: 100%;
    z-index: 9999 !important;
  }
  .mainQ{
    border: none; border-color: transparent; font-size: 30px; width:100%;
    background-color: transparent;border-bottom: 3px dotted green;
  }
  .form_ttl{
    border: none; border-color: transparent; font-size: 20px; width:30%%;
    background-color: transparent;border-bottom: 3px solid blue; margin : 10px;
  }
  .option{
    border: none; border-color: transparent; font-size: 20px;
    background-color: transparent;color: blue;
  }
  .textans, .otheroptn, .form_desc{
    border: none; border-color: transparent; font-size: 20px;
    background-color: transparent; border-bottom: 3px solid blue; margin: 8px;
  }
  .oneq{
    background-color: rgb(153, 255, 102); border: 2px solid red;margin: 8px;
    padding: 1px 1px 5px 2px;
  }
  .textans_div{
    background-color: rgb(102, 255, 255); border: 2px solid red;margin: 10px;
    padding: 1px 1px 2px 3px;
  }
  .options_div{
    background-color: rgb(102, 255, 255); border: 2px solid red;margin: 10px;
    padding: 1px 1px 8px 3px;
  }

  .Qtype{
    margin: 20px;align-content: center; font-size: 20px;
  }
  .removebtn{
    margin: 20px;
  }
  .requiretext{
    margin: 8px; font-size:15px; color: green;
  }
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}
.result_div{
  background-color: rgb(153, 255, 102); border: 2px solid black;margin: 10px;
}
</style>
</head>
<body data-spy="scroll" data-offset="125">

<div class="container-fluid" style="background-color:rgb(102, 204, 255); height: 70px; text-align: center;">
  <h1>create your form</h1>
</div>

<div class="container-fluid" style="background-color:rgb(255, 153, 0);">
	<a href="/user/">Dashboard</a>
	<input type="text" name="form_title" class="form_ttl" value="{{form.survey.title}}">
	<input type="text" name="form_desc" class="form_desc" value="{{form.survey.desc}}">
	<span> accept response till :-</span>
	<input type="date" name="form_exdate" >
	<input type="time" name="form_extime" >
	 

	<!-- {% for section, ques_dict in form.dictionary.items %}
		<h4>{{section.title}} aaaaaaaaaaaaaa</h4>  
		{% for ques, opt_lst in ques_dict.items %}
			<h5>{{ques.desc}}</h5>  
			{% for option in opt_lst %}
				<p>{{option.value}}</p>
			{% endfor %}
		{% endfor %}
	{% endfor %} -->
</div>
<!-- buttons -->
<div data-spy="affix" data-offset-top="125" class="container-fluid" 
	style="background-color: rgb(255, 102, 255); text-align: center; ">

  		<button onclick="crtdiv()" style="margin: 8px; font-size: 20px;"> Add a question </button>

		<form id="save_form" action="/user/editor/{{form.survey.id}}" method="POST" style="line-break:strict;">
			{% csrf_token %}
			<div style="display: none;">
			<input name="input1" id="table1" style="width: 100%;"> <br>
			<input name="input2" id="table2" style="width: 100%;"> <br>
			<input name="input3" id="table3" style="width: 100%;"> <br>
			<input name="input4" id="table4" style="width: 100%;"> <br>
			<input name="input5" id="table5" style="width: 100%;"> <br>
			</div>
			<input type="submit" onclick="show()" value="Save" style="margin: 8px; font-size: 20px;">
		</form>

</div>     
  
<!-- all question -->
<div class="container-fluid container" style="background-color:yellow; width: 100%;">
	<h3>Preview</h3>
   <ol id="myList"></ol>
</div>


<!-- all functions are here -->
<script>
function crtdiv() {
  var my_div = document.createElement("div");
  var ans_div = document.createElement("div");
  var rmbtn = document.createElement("button");
  var copybtn = document.createElement("button");
  var askQ = document.createElement("input");
  var ans = document.createElement("input");
  var label = document.createElement("label");
  var rcheckbox = document.createElement("input");
  var round = document.createElement("span");

  var textarr = ["Short Ans ","Paragraph","Multiple choice",
        "Checkboxes","Drop-down","File upload","linear scale",
        "multiple choice grid","tick box grid","Date","Time"];

  //Create and append select list
  var qtypeselect = document.createElement("select");
  my_div.appendChild(qtypeselect);

  //Create and append the options
  for (var i = 0; i < textarr.length; i++) {
      var option = document.createElement("option");
      option.text = textarr[i];
      qtypeselect.appendChild(option);
  }

  my_div.setAttribute("class", "oneq");               
  ans_div.setAttribute("class", "textans_div");               
  rmbtn.setAttribute("class", "removebtn");
  rmbtn.setAttribute("onclick", "Delete(this)");
  copybtn.setAttribute("class", "removebtn");
  copybtn.setAttribute("onclick", "Copy(this)");
  qtypeselect.setAttribute("onchange", "modifyQ(this)");
  qtypeselect.setAttribute("class", "Qtype");
  askQ.setAttribute("class", "mainQ");
  askQ.setAttribute("value", "write your question here");
  ans.setAttribute("value", " short ans here");
  ans.setAttribute("class", "textans");
  ans.setAttribute("type", "text");
  ans.setAttribute("disabled", true);

  label.setAttribute("class","switch" )
  rcheckbox.setAttribute("type","checkbox" )
  round.setAttribute("class","slider round" )
  
  var rmtext = document.createTextNode("remove");
  var copytext = document.createTextNode("Copy");
  var requiretext = document.createTextNode("Require");
  // requiretext.setAttribute("class", "requiretext");


  label.appendChild(rcheckbox);
  label.appendChild(round);

  rmbtn.appendChild(rmtext);

  my_div.appendChild(rmbtn);
  my_div.appendChild(copybtn);
  my_div.appendChild(requiretext);

  my_div.appendChild(label);

  copybtn.appendChild(copytext);
  my_div.appendChild(askQ);
  ans_div.appendChild(ans);
  my_div.appendChild(ans_div);


  var node = document.createElement("LI");
  node.appendChild(my_div);
  document.getElementById("myList").appendChild(node);
  // li.setAttribute("id", i);
  // document.getElementById("element_id").remove();
}
function Delete(button) {
    var parent = button.parentNode;
    var grand_father = parent.parentNode;
    var gg_father = grand_father.parentNode;
    gg_father.removeChild(grand_father);
  }
function Copy(button) {
  var parent = button.parentNode;
  var clone = parent.cloneNode(true);

  var node = document.createElement("LI");
  node.appendChild(clone);
  document.getElementById("myList").appendChild(node);
}
function modifyQ(button){
  var ind = button.selectedIndex;
  var parent = button.parentNode;

  if (ind ==0 || ind ==1) {
      var ansdiv = parent.querySelector('.textans_div');
      if(parent.contains(ansdiv)){
        var ansinfld =ansdiv.querySelector('input');
        if(ind ==0) { ansinfld.setAttribute("value", "short answer here"); } 
        else { ansinfld.setAttribute("value", "long answer here"); } 
      }
      else{
          var ansdivoptn = parent.querySelector("div:not(.textans_div)");
          ansdivoptn.remove();

        var ans_newdiv = document.createElement("div");
        ans_newdiv.setAttribute("class", "textans_div");                

        var shortans = document.createElement("input");
        shortans.setAttribute("class", "textans");                
        shortans.setAttribute("type", "text");
        shortans.setAttribute("disabled", true);                
        if(ind == 0){ shortans.setAttribute("value", "short answer here"); }
        if(ind==1) {      shortans.setAttribute("value", "long answer here"); }
        
        ans_newdiv.appendChild(shortans);
        parent.appendChild(ans_newdiv);
    }
  }

    else if(ind >= 2 && ind <=4) {
      var ansdiv = parent.querySelector('.options_div');
      if(parent.contains(ansdiv)){}
      else{
          var ansdiv2 =parent.querySelector("div:not(.options_div)");
          ansdiv2.remove();

        var ans_newdiv = document.createElement("div");
        var optnlist = document.createElement("ul");
        var optnlist2 = document.createElement("ul");
        var option1 = document.createElement("li");
        var extraoptn = document.createElement("li");
        var optnval = document.createElement("input");
        var optbtn = document.createElement("button");
        var otherbtn = document.createElement("button");

        var addtxt = document.createTextNode("Add new Option");
        var othertxt = document.createTextNode("Other");
        var ortxt = document.createTextNode("  OR  ");

        ans_newdiv.setAttribute("class", "options_div");                
        optnval.setAttribute("class", "option");                
        optnval.setAttribute("type", "text");               
        optnval.setAttribute("value", "Option-1");

        optbtn.setAttribute("onclick", "addopt(this)");               
        otherbtn.setAttribute("onclick", "addother(this)");

        optbtn.appendChild(addtxt);
        otherbtn.appendChild(othertxt);
        extraoptn .appendChild(optbtn);
        extraoptn .appendChild(ortxt);
        extraoptn .appendChild(otherbtn);

        option1 .appendChild(optnval);
        optnlist.appendChild(option1);                    
        optnlist2.appendChild(extraoptn);
        ans_newdiv.appendChild(optnlist);
        ans_newdiv.appendChild(optnlist2);
        parent.appendChild(ans_newdiv);
      }
    }
    else if(ind == 5){
        var olderans_div =parent.querySelector("div");
        olderans_div.remove();

      var ans_newdiv = document.createElement("div");
      ans_newdiv.setAttribute("class", "file_div");

      var file_in = document.createElement("input");
      var note = document.createTextNode(" user will upload a file here ");
      file_in.setAttribute("type", "file");
      file_in.setAttribute("class", "file_input");
      file_in.setAttribute("disabled", true);

      ans_newdiv.appendChild(file_in);
      ans_newdiv.appendChild(note);
      parent.appendChild(ans_newdiv);
    }
    else if(ind == 6){
        var olderans_div =parent.querySelector("div");
        olderans_div.remove();

      var ans_newdiv = document.createElement("div");
      ans_newdiv.setAttribute("class", "scale_div");

      var start = document.createTextNode(" start-label:- ");
      var end = document.createTextNode(" end-label:- ");
      var to = document.createTextNode(" to ");
      var start_in = document.createElement("input");
      var end_in = document.createElement("input");

      var startarr = [0,1];
      var endarr = [2,3,4,5,6,7,8,9,10];

      var select_start = document.createElement("select");
      var select_end = document.createElement("select");

      for (var i = 0; i < startarr.length; i++) {
          var option = document.createElement("option");
          option.text = startarr[i];
          select_start.appendChild(option);
      }
      for (var i = 0; i < endarr.length; i++) {
          var option = document.createElement("option");
          option.text = endarr[i];
          select_end.appendChild(option);
      }

      ans_newdiv.appendChild(select_start);
      ans_newdiv.appendChild(to);                   
      ans_newdiv.appendChild(select_end);
      ans_newdiv.appendChild(start);
      ans_newdiv.appendChild(start_in);
      ans_newdiv.appendChild(end);
      ans_newdiv.appendChild(end_in);
      parent.appendChild(ans_newdiv);
    }

    else if(ind == 7 || ind ==8) {
      var ansdiv = parent.querySelector('.RCoptions_div');
      if(parent.contains(ansdiv)){}
      else{
          var ansdiv2 =parent.querySelector("div:not(.RCoptions_div)");
          ansdiv2.remove();

        var ans_newdiv = document.createElement("div");
        ans_newdiv.setAttribute("class", "RCoptions_div");  
        var rowtxth = document.createElement("h4");
        var coltxth = document.createElement("h4");
        var RowoptnList = document.createElement("ul");
        var RowoptnList2 = document.createElement("ul");
        var option1 = document.createElement("li");
        var extraoptn = document.createElement("li");
        var optnval = document.createElement("input");
        var optbtn = document.createElement("button");

        var addtxt = document.createTextNode("Add new Option");
        var othertxt = document.createTextNode("Other");
        var rowtxt = document.createTextNode("Rows:-");
        var coltxt = document.createTextNode("Columns:-");

        rowtxth .appendChild(rowtxt);
        coltxth .appendChild(coltxt);

        optnval.setAttribute("class", "option");                
        optnval.setAttribute("type", "text");               
        optnval.setAttribute("value", "Option-1");

        optbtn.setAttribute("onclick", "addopt(this)");               

        optbtn.appendChild(addtxt);
        extraoptn .appendChild(optbtn);

        option1 .appendChild(optnval);
        RowoptnList.appendChild(option1);                   
        RowoptnList2.appendChild(extraoptn);
  var ColoptnList = document.createElement("ul");
  var ColoptnList2 = document.createElement("ul");
  var option1 = document.createElement("li");
  var extraoptn = document.createElement("li");
  var optnval = document.createElement("input");
  var optbtn = document.createElement("button");

  var addtxt = document.createTextNode("Add new Option");
  var othertxt = document.createTextNode("Other");

  optnval.setAttribute("class", "option");                
  optnval.setAttribute("type", "text");               
  optnval.setAttribute("value", "Option-1");

  optbtn.setAttribute("onclick", "addopt(this)");               

  optbtn.appendChild(addtxt);
  extraoptn .appendChild(optbtn);

  option1 .appendChild(optnval);
  ColoptnList.appendChild(option1);                   
  ColoptnList2.appendChild(extraoptn);

        ans_newdiv.appendChild(rowtxth);
        ans_newdiv.appendChild(RowoptnList);
        ans_newdiv.appendChild(RowoptnList2);
        ans_newdiv.appendChild(coltxth);
        ans_newdiv.appendChild(ColoptnList);
        ans_newdiv.appendChild(ColoptnList2);
        parent.appendChild(ans_newdiv);
      }
    }

    else if(ind==9){
        var olderans_div =parent.querySelector("div");
        olderans_div.remove();

      var ans_newdiv = document.createElement("div");
      ans_newdiv.setAttribute("class", "date_div");

      var date_in = document.createElement("input");
      date_in.setAttribute("type", "date");

      ans_newdiv.appendChild(date_in);
      parent.appendChild(ans_newdiv);
    }
    else if(ind==10){
        var olderans_div =parent.querySelector("div");
        olderans_div.remove();

      var ans_newdiv = document.createElement("div");
      ans_newdiv.setAttribute("class", "time_div");

      var time_in = document.createElement("input");
      time_in.setAttribute("type", "time");

      ans_newdiv.appendChild(time_in);
      parent.appendChild(ans_newdiv);
    }
    else{}
  }

function addopt(button){
  var parent = button.parentNode;
  var grand_father = parent.parentNode.previousSibling;
  var optnindex = grand_father.childElementCount + 1;

  var option2 = document.createElement("li");
  var optnval = document.createElement("input");
  var remove_opt = document.createElement("button");
  var remove_txt = document.createTextNode(" Remove Option");

  optnval.setAttribute("class", "option");                
  optnval.setAttribute("type", "text");               
  optnval.setAttribute("value","Option-" + optnindex);
  remove_opt.setAttribute("onclick","remove_opt(this)");

  remove_opt.appendChild(remove_txt);
  option2 .appendChild(optnval);
  option2 .appendChild(remove_opt);

  grand_father.appendChild(option2);
}

function addother(button){
    var parent = button.parentNode;
    var grand_father = parent.parentNode;
    if(grand_father.childElementCount > 1){}

    else{
    var othroptn = document.createElement("li");
    var optnval = document.createElement("input");
    var remove_opt = document.createElement("button");
    var remove_txt = document.createTextNode(" Remove Option");

    optnval.setAttribute("class", "otheroptn");               
    optnval.setAttribute("type", "text");               
    optnval.setAttribute("value","Other ...");
    optnval.setAttribute("disabled",true);
    remove_opt.setAttribute("onclick","remove_opt(this)");

    remove_opt.appendChild(remove_txt);
    othroptn.appendChild(optnval);
    othroptn.appendChild(remove_opt);

    grand_father.insertBefore(othroptn, grand_father.lastChild);
  }
}
function remove_opt(button) {
    var parent = button.parentNode;
    var grand_father = parent.parentNode;
    grand_father.removeChild(parent);
  }
</script>
<script>
	function show(){
		var myinput1 = document.getElementById("table1");
		var myinput2 = document.getElementById("table2");
		var myinput3 = document.getElementById("table3");
		var myinput4 = document.getElementById("table4");
		var myinput5 = document.getElementById("table5");

		var sp1 = "#~#";
		var text1 = "";
		for (var i = 0; i < 5; i++) {
			
		text += "The number is " + i + "<br>";
		}
		myinput1.setAttribute("value", text);
		myinput2.setAttribute("value", text);
		myinput3.setAttribute("value", text);
		myinput4.setAttribute("value", text);
		myinput5.setAttribute("value", text);

		//document.getElementById("save_form").submit();
	}
</script>
</body>
</html>
